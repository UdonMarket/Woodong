<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper  namespace="model.WooBoardDAOImpl" >

	<!-- 방명록 리스트 게시물 갯수 카운트  버전 (1)-->
	<!-- <select id="getTotalCount" resultType="int" >
	SELECT  count(*) FROM woo_board
	 </select>  -->
	 
	 
	 <select id="getTotalCount" resultType="int" parameterType="model.ParameterVO">
		SELECT  count(*) FROM woo_board
	<if test="searchTxt != null and !searchTxt.equals('')">
        WHERE ${searchField} LIKE '%'||#{searchTxt}||'%' 
    </if>
	 </select> 

	 
	 <!--방명록 리스트 : start 와 end 에 해당하는 게시물 가져오기 (페이지 처리)  -->
	 
	 <!--방명록 리스트 버전 1)  -->
	<!--
	  <select id="listPage" resultType="mybatis.MyBoardDTO"  parameterType="int">
	 SELECT * FROM 
	 	( SELECT Tb.*, rownum rNum FROM 
	 		(SELECT * FROM myboard 
	 		
	 		order by idx DESC ) Tb) 
	 			WHERE rNum BETWEEN #{param1} AND #{param2}
	 </select> 
	 -->
	 
	 <!-- 방명록 리스트 버전 2) -->
	 <select id="listPage" resultType="model.WooBoardVO"  parameterType="model.ParameterVO">
	 SELECT * FROM 
	 	( SELECT Tb.*, rownum rNum FROM 
	 		(SELECT * FROM woo_board 
	<if test="searchTxt != null and !searchTxt.equals('')">
        WHERE ${searchField} LIKE '%'||#{searchTxt}||'%' 
    </if>
	 		order by idx DESC ) Tb) 
	 			WHERE rNum BETWEEN #{start} AND #{end}
	 </select> 
	 
	 
	 <!--  <select id="listPage" resultType="model.WooBoardVO" >
	 	 SELECT * FROM woo_board 
	 </select> -->
	 
	 
	<!--  글쓰기 : 파라미터를 전달하는 3번째 방식 -->	 
	  <insert id="write">
	 	INSERT INTO woo_board (idx,id,title,contents,bname,image,price,good_state) 
	 			VALUES (woo_board_seq.nextval,#{id},#{title},#{contents},#{bname},#{image},#{price},#{good_state})
	 </insert>
	 
	 
	 
	 <!-- 상세보기 -->
	 <select resultType="model.WooBoardVO" id="view" parameterType="String">
	 	select * from woo_board where idx = #{param1} 
	 </select>
	 
	 <!--  
	  수정처리하기
	 -->
	 <update id="modify" parameterType="model.WooBoardVO" >
	 	UPDATE woo_board SET contents = #{contents} , name=#{name} WHERE idx= #{idx} AND id=#{id} 
	 </update>
	 
	 <!--  삭제하기-->
	 <delete id="delete" parameterType="String">
	 	DELETE FROM woo_board WHERE idx= #{param1} AND id=#{param2}
	 </delete>
	 
	 
	 
	 
	 
	 
</mapper>